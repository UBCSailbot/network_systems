set(CMAKE_CXX_CLANG_TIDY "")  # disable clang tidy checks for autogenerated protobuf files

# Generate and add protobuf libraries
file(GLOB ProtoFiles "${CMAKE_CURRENT_LIST_DIR}/*.proto")
protobuf_generate_cpp(ProtoSrcs ProtoHdrs ${ProtoFiles})
add_library(protofiles STATIC ${ProtoSrcs} ${ProtoHdrs})
target_include_directories(protofiles PUBLIC ${CMAKE_CURRENT_BINARY_DIR})
target_link_libraries(protofiles ${PROTOBUF_LIBRARY})
# The generated headers are placed in the binary directory - save the path so we can include/link it
set(PROTO_BUF_INCLUDE_DIR ${CMAKE_CURRENT_BINARY_DIR}
    CACHE INTERNAL "Path to generated protobuf files")

set(CMAKE_CXX_CLANG_TIDY "clang-tidy-${LLVM_VERSION}")  # re-enable clang tidy checks
